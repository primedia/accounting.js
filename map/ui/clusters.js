// Generated by CoffeeScript 1.6.3
(function() {
  'use strict';
  define(['flight/lib/component', 'lib/marker-clusterer/marker-clusterer', 'utils'], function(defineComponent, markerClusterer, Utils) {
    var initMarkerClusters;
    initMarkerClusters = function() {
      this.defaultAttrs({
        mapPinCluster: Utils.assetURL() + "/images/nonsprite/map/map_cluster_red4.png",
        markerClusterer: void 0
      });
      this.clearMarkers = function() {
        this.unbindMarkers();
        this.attr.markers.clearMarkers();
        return this.teardown();
      };
      this.unbindMarkers = function() {
        return $.each(this.attr.markerClusterer, function(index, marker) {
          return google.maps.event.clearListeners(marker, "click");
        });
      };
      this.mapClusterOptions = function() {
        var style;
        style = {
          height: 40,
          url: this.attr.mapPinCluster,
          width: 46,
          textColor: "black"
        };
        return {
          styles: [style, style, style, style, style],
          minimumClusterSize: 5
        };
      };
      this.initClusterer = function(ev, data) {
        return this.attr.markerClusterer = new MarkerClusterer(data.gMap, [], this.mapClusterOptions());
      };
      this.setClusterImage = function(ev, data) {
        this.attr.mapPinCluster = data.pinsClusterImage;
        return this.off(document, 'clusterImageChange');
      };
      return this.after('initialize', function() {
        this.on(document, 'mapRenderedFirst', this.initClusterer);
        return this.on(document, 'clusterImageChange', this.setClusterImage);
      });
    };
    return initMarkerClusters;
  });

}).call(this);
